Instructions for making the MCJet calibrations on the CMS UAF at Fermilab.
Author: Robert Harris
Date: January 4, 2007

1) Get and build the code for your release and go to test area:

     source /afs/fnal.gov/files/code/cms/setup/cshrc uaf
     scramv1 project CMSSW CMSSW_1_0_3
     cd CMSSW_1_0_3/src
     cmscvsroot CMSSW
     cvs co -r JetResponseV5 JetMETCorrections/MCJet
     eval `scramv1 runtime -csh`
     scramv1 b
     cd JetMETCorrections/MCJet/test

2) modify test config SimJetResponseAnalysis.cfg to point to your test sample.

3) run test job

     cmsRun SimJetResponseAnalysis.cfg >&! SimJetResponseAnalysis.log &

   and look at output file SimJetResponseMidPoint_R05_test.root

4) Modify full config files to point at your full sample
   Modify SimJetCSA06*.cfg and write out SimJet*.cfg without the CSA06
   (SimJet_MidpointR5.cfg,  SimJet_MidpointR7.cfg, SimJet_IterativeR5.cfg, etc.)
   
5) Make the condor jobs:
     source createCondorJob.csh 
   Examine the output job on stdout. If it looks OK, make the rest
     source moreCondorJobs.csh
   and submit the jobs
     condor_submit CondorJob_MidPointR5
     condor_submit CondorJob_MidPointR7
     condor_submit CondorJob_IterativeR5
     condor_submit CondorJob_Kt
      
6) When the jobs complete, make the checking scripts
     source makeCheckingScripts.csh
   This puts you in the check directory. Run the 
   scripts in the appropriate sub-directory of check:
     cd MC5; source runChecksMC5.csh; cd ..;
     cd MC7; source runChecksMC7.csh; cd ..;
     cd IC5; source runChecksIC5.csh; cd ..;
     cd KT;  source runChecksKT.csh; cd ..;
   examining the histos and type .q at the root prompt between plots.
   The histograms are saved as .gif, .eps and .ps files.

7) Make the analysis scripts from the MCJet/test directory
     source makeAnalysisScripts.csh
   This puts you in the ana directory. Run the 
   scripts in the appropriate sub-directory of ana:
     cd MC5; source runAna.csh; cd ..;
     cd MC7; source runAna.csh; cd ..; NOT TESTED YET
     cd IC5; source runAna.csh; cd ..; NOT TESTED YET
     cd KT;  source runAna.csh; cd ..; NOT TESTED YET
   make sure the 1 sigma Gaussian fits are working and the fit of
   the response versus Et is working. Type .q at the root prompt between
   each set of plots. The gaus fits are saved in the /tmp sub-directory for
   each algorithm, the response vs Et is saved, the parameters are saved,
   and the output calibration file is made and saved as calibration.txt.
   
8) Copy the calibration text file to the MCJet/data area and give it a name
   that identifies both the algorithm and the software release of the sample.
   Create a .cff file that contains that name: 
       string tagName = 'myCalibrationName'

9) Modify corrected jet config files to point at your full sample.
   Modify CorJetCSA06_MidPointR5.cfg and write out CorJet_MidPointR5.cfg, etc.
    
10) Submit the condor jobs for corrected jet response histograms:
     condor_submit CondorJob_MidPointR7_Cor
     condor_submit CondorJob_MidPointR5_Cor
     condor_submit CondorJob_IterativeR5_Cor
     condor_submit CondorJob_Kt_Cor
     
11) When the jobs complete, make the corrected jet analysis scripts
      source makeCorrResponseScripts.csh
   This puts you in the cor directory. Run the 
   scripts in the appropriate sub-directory of cor:
     cd MC5; source runCorrResponse.csh; cd ..;
     cd MC7; source runCorrResponse.csh; cd ..; NOT TESTED YET
     cd IC5; source runCorrResponse.csh; cd ..; 
     cd KT;  source runCorrResponse.csh; cd ..; NOT TESTED YET
   Type .q at the root prompt between each set of plots. The gaus fits 
   are saved in the /tmp sub-directory for each algorithm, and the corrected 
   response vs Et is saved.
